<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WV23EXEF9X"></script>
<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-WV23EXEF9X');
</script>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F66ae2268-69fb-4a91-a4a8-fea3ba4543a5%2Fbluesyu.png?table=collection&amp;id=12c44699-617b-45ed-a019-c3b075e0ae01">

<style>
  :root {
    font-size: 20px;
  }
</style>

  <title>ä¸è¦å¾€ AMQP çš„ Header ä¹±å¡ä¸œè¥¿&nbsp;|&nbsp;å¸ƒé²æ–¯é±¼çš„å¥‡æ€ä¹±æƒ³ ğŸ’­</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="ä¸è¦å¾€ AMQP çš„ Header ä¹±å¡ä¸œè¥¿">
  
    <meta name="description" content="å†…å®¹è¿‡åº¦å°è£…ï¼Œæ ‡é¢˜è¿‡äºç›´ç™½">
    <meta property="og:description" content="å†…å®¹è¿‡åº¦å°è£…ï¼Œæ ‡é¢˜è¿‡äºç›´ç™½">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸš¨&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F66ae2268-69fb-4a91-a4a8-fea3ba4543a5%2Fbluesyu.png?table=collection&amp;id=12c44699-617b-45ed-a019-c3b075e0ae01"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3a9bcf6a-f4f8-4580-93a6-b21a38a8914b%2F988431636594419_.pic.jpg?table=block&amp;id=78f0b500-97be-4b05-ad6d-630418880655"></span>&nbsp;
          
          <span>å…³äºæˆ‘</span>
        </div>
      </a>
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸš¨&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">ä¸è¦å¾€ AMQP çš„ Header ä¹±å¡ä¸œè¥¿</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Wed, Nov 17, 2021</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/python.html">python</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/celery.html">celery</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/amqp.html">amqp</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/tcp.html">tcp</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/tech.html">tech</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/4747566399fc4dabb21296bbc212202b" class="PageRoot PageRoot--FullWidth"><h2 id="https://www.notion.so/47cb9f1e261d4b5894662583d41d1594" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/47cb9f1e261d4b5894662583d41d1594"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">å‰æƒ…æè¦</span></span></h2><div id="https://www.notion.so/3c0aa696216345ccbcfb693374258d4d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ä¸€ç›´ä»¥æ¥ï¼Œæˆ‘ä»¬åœ¨ Python é¡¹ç›®ä¸­çš„åå°ä»»åŠ¡éƒ½æ˜¯ä½¿ç”¨ celery æ­é… Redis(ä½œä¸º broker)æ¥å®Œæˆï¼ŒåŒæ—¶é’ˆå¯¹çŸ­ä»»åŠ¡è½®è¯¢åœºæ™¯æˆ‘ä»¬ä¹Ÿ</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/TencentBlueKing/bkpaas-python-sdk/tree/master/sdks/blue-krill/blue_krill/async_utils">åšäº†ä¸€äº›å°è£…</a></span><span class="SemanticString">ã€‚åœ¨é¡¹ç›®è¿è¡Œçš„ä¸‰~å››å¹´é—´ï¼Œè¿™å¥—æ–¹æ¡ˆå®Œç¾åœ°æ‰¿è½½äº†æˆ‘ä»¬æ ¸å¿ƒåŠŸèƒ½ã€‚</span></span></p></div><div id="https://www.notion.so/818e96e80bd94d1386800bedf85eab56" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ç„¶è€Œï¼Œå°±åœ¨ä¸ä¹…å‰çš„ä¸€å‘¨ï¼Œå‡ºç°ä¸€äº›æ¯”è¾ƒè¯¡å¼‚çš„é—®é¢˜ï¼Œæ€»æ˜¯æœ‰äº›åå°ä»»åŠ¡å‘ç”Ÿé˜»å¡ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å¤šç§å¼‚å¸¸è§‚æµ‹æ‰‹æ®µï¼ˆ</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sentry.io/">Sentry</a></span><span class="SemanticString">ã€æ—¥å¿—ç­‰ï¼‰éƒ½æ— æ³•å‡†ç¡®å®šä½åˆ°å…·ä½“é—®é¢˜ï¼ˆè¿™æˆ–è®¸æ˜¯å¦ä¸€ä¸ªæ•…äº‹ï¼‰ï¼Œäºæ˜¯æ­»é©¬å½“æ´»é©¬åŒ»ï¼Œæˆ‘ä»¬å†³å®šå°† Redis æ›´æ¢ä¸º RabbitMQï¼Œè¿™æ ·èƒ½å¤Ÿæ›´ä¸ºå‡†ç¡®åœ°è§‚æµ‹åˆ°ä»»åŠ¡å…·ä½“æ‰§è¡Œçš„æ¶ˆæ¯æƒ…å†µï¼ˆä¾‹å¦‚æ˜¯å¦åŠæ—¶Ackï¼‰ã€‚</span></span></p></div><h2 id="https://www.notion.so/9b9688d530f1473786531dd498aec3b3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/9b9688d530f1473786531dd498aec3b3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">æ¡ˆå‘ç°åœº</span></span></h2><div id="https://www.notion.so/3b8fd387bdcd4dbea69ba2db755d8e0d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">æ›´æ¢å®Œ broker ä¹‹åï¼Œå´å‘ç°äº†å¦ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼ˆæ²¡é”™ï¼Œè¿™æ‰æ˜¯æœ¬æ–‡çš„ä¸»è§’ï¼‰ã€‚æˆ‘ä»¬åœ¨æŸä¸€äº›ç‰¹æ®Šèµ„æºçš„åœºæ™¯ä¸‹ï¼Œcelery ä»»åŠ¡ä¼šç›´æ¥æŠ¥é”™ï¼š</span></span></p></div><pre id="https://www.notion.so/a954e0ab701c43978a33bdd5b6c8acf3" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>ConnectionResetError<span class="token punctuation">:</span> <span class="token punctuation">[</span>Errno <span class="token number">104</span><span class="token punctuation">]</span> Connection reset by peer
  File <span class="token string">"kombu/connection.py"</span><span class="token punctuation">,</span> line <span class="token number">414</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _reraise_as_library_errors
    <span class="token keyword">yield</span>
  File <span class="token string">"kombu/connection.py"</span><span class="token punctuation">,</span> line <span class="token number">494</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _ensured
    <span class="token keyword">return</span> fun<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
  File <span class="token string">"kombu/messaging.py"</span><span class="token punctuation">,</span> line <span class="token number">203</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _publish
    mandatory<span class="token operator">=</span>mandatory<span class="token punctuation">,</span> immediate<span class="token operator">=</span>immediate<span class="token punctuation">,</span>
  File <span class="token string">"amqp/channel.py"</span><span class="token punctuation">,</span> line <span class="token number">1766</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _basic_publish
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routing_key<span class="token punctuation">,</span> mandatory<span class="token punctuation">,</span> immediate<span class="token punctuation">)</span><span class="token punctuation">,</span> msg
  File <span class="token string">"amqp/abstract_channel.py"</span><span class="token punctuation">,</span> line <span class="token number">59</span><span class="token punctuation">,</span> <span class="token keyword">in</span> send_method
    conn<span class="token punctuation">.</span>frame_writer<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>channel_id<span class="token punctuation">,</span> sig<span class="token punctuation">,</span> args<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
  File <span class="token string">"amqp/method_framing.py"</span><span class="token punctuation">,</span> line <span class="token number">154</span><span class="token punctuation">,</span> <span class="token keyword">in</span> write_frame
    <span class="token number">2</span><span class="token punctuation">,</span> channel<span class="token punctuation">,</span> framelen<span class="token punctuation">,</span> frame<span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  File <span class="token string">"amqp/transport.py"</span><span class="token punctuation">,</span> line <span class="token number">305</span><span class="token punctuation">,</span> <span class="token keyword">in</span> write
    self<span class="token punctuation">.</span>_write<span class="token punctuation">(</span>s<span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/492e4057b6694256962670188e820806" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†ä¸€å±‚ </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://cloud.tencent.com/product/clb">CLB</a></span><span class="SemanticString"> ä½œä¸ºé«˜å¯ç”¨ä»£ç†ï¼Œè€Œä¹‹å‰çš„ä½¿ç”¨ç»éªŒä¸­ï¼ŒCLB å¯èƒ½ä¼šæœ‰ä¸€äº›é•¿æ—¶é—´æ— æ•°æ®æ–­è¿çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬æš‚æ—¶è®¤ä¸ºå¯èƒ½æ˜¯æŸäº›é•¿æ—¶é—´çš„é˜»å¡ä»»åŠ¡ä¼šå¯¼è‡´ CLB ä¸»åŠ¨æ–­å¼€ï¼Œä¸ºäº†æ’é™¤å¹²æ‰°ï¼Œæˆ‘ä»¬ç”©å¼€äº† CLBï¼Œç›´æ¥é‡‡ç”¨ MQ çš„å¤šä¸ªèŠ‚ç‚¹ä½œä¸ºåœ°å€ç›´è¿ã€‚</span></span></p></div><div id="https://www.notion.so/f2c09f05b09c48b4a43bed880df63f92" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ç„¶è€Œï¼Œé—®é¢˜ä¾æ—§ï¼Œä¸€æ—¶é—´åˆæ²¡äº†å¤´ç»ªï¼Œæˆ‘å¼€å§‹æ¼«æ— ç›®çš„é‡æ–°æµè§ˆ Sentry ä¸­çš„é”™è¯¯å †æ ˆä»¥åŠç›¸å…³å˜é‡ã€‚</span></span></p></div><h2 id="https://www.notion.so/84b6265e8fc5450c8cbb7bf2777ab996" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/84b6265e8fc5450c8cbb7bf2777ab996"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">è››ä¸é©¬è¿¹</span></span></h2><div id="https://www.notion.so/36b504203564410e976101c0f02a4085" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">æ— æ„é—´ï¼Œå‘ç°åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°è¯•å‘é˜Ÿåˆ—ä¸­å­˜å‚¨ä¸€å¤§æ®µ pickle è¿‡çš„å¯¹è±¡æ•°æ®ï¼Œè€Œè¿™äº›å˜é‡åœ¨ Sentry ä¸­å·²ç»é•¿åˆ°æ— æ³•å®Œæ•´æ˜¾ç¤ºè€Œè¢«çœç•¥äº†ã€‚</span></span></p></div><pre id="https://www.notion.so/9b2c4caf8622467593dc596137c5b627" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
any_task<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>headers<span class="token operator">=</span>something_big<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span></span></span></code></pre><div id="https://www.notion.so/3ff159c3d15f47d692bbbc84558584ef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™ä¸ªé—®é¢˜ç«‹é©¬å¼•èµ·äº†æˆ‘ä»¬çš„æ³¨æ„ğŸ¤”ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯è¿™ä¸ªæ•°æ®è¿‡å¤§è€Œå¼•èµ·å†™å…¥å¼‚å¸¸ã€‚</span></span></p></div><h2 id="https://www.notion.so/cdf4e94974234d39b17490c1007821fe" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/cdf4e94974234d39b17490c1007821fe"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ç ´æ¡ˆ</span></span></h2><div id="https://www.notion.so/bcd4b93878464e509a7938b938a83ce3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ç…§æ­¤æ€è·¯ï¼Œç»è¿‡ä¸€ç•ªç½‘ç»œå†²æµªï¼Œå‘ç°äº†ç±»ä¼¼çš„é—®é¢˜ï¼š</span></span></p></div><div id="https://www.notion.so/124a8900aa364777a507f008b1d88005" class="Bookmark"><a href="https://stackoverflow.com/questions/30716002/is-there-a-size-limit-on-a-rabbitmq-message-header"><p class="Bookmark__Link">https://stackoverflow.com/questions/30716002/is-there-a-size-limit-on-a-rabbitmq-message-header</p></a></div><div id="https://www.notion.so/845cd6a1ad2b47118ca17cfbc273d9ca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™æ—¶å€™ï¼Œå†å»åæŸ¥ RabbitMQ çš„æ—¥å¿—ï¼Œæœç„¶æœ‰å¯¹åº”å†…å®¹ï¼š</span></span></p></div><pre id="https://www.notion.so/d33033652f914e748eed2d655646939f" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGray"><span>2021-11-16 19:49:32.098</span></mark></span><span class="SemanticString"><span> [</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><span>error</span></mark></span><span class="SemanticString"><span>] &lt;0.3894.1636&gt; </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPink"><span>Error on AMQP connection &lt;0.3894.1636&gt; (x.x.x.x:59823 -&gt; x.x.x.x:5672, vhost: &#x27;foo&#x27;, user: &#x27;foo&#x27;, state: running), channel 1:
 operation none caused a connection exception frame_error: &quot;type 2, all octets = &lt;&lt;&gt;&gt;: {</span></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><span>frame_too_large</span></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPink"><span>,245629,131064}&quot;
</span></mark></span><span class="SemanticString"><span>
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGray"><span>2021-11-16 19:49:35.099</span></mark></span><span class="SemanticString"><span> [</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><span>error</span></mark></span><span class="SemanticString"><span>] &lt;0.3894.1636&gt; </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPink"><span>closing AMQP connection &lt;0.3894.1636&gt; (x.x.x.x:59823 -&gt; x.x.x.x:5672):
</span></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><span>fatal_frame_error</span></mark></span></span></code></pre><div id="https://www.notion.so/af8a5b9adda245b48c1ae1e63ce0beda" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™é‡Œéå¸¸æ˜ç¡®åœ°æŒ‡å‡ºäº†ï¼Œç”±äºæˆ‘ä»¬ä¼ é€’çš„ frame å¤§å°(</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorPink">245629 bytes</mark></span><span class="SemanticString">) å¤§äºé»˜è®¤çš„ </span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen">131064 + 8(frame header) bytes (128KB)</mark></span><span class="SemanticString">ï¼Œæ‰€ä»¥ RabbitMQ å…³é—­äº†è¿æ¥ã€‚</span></span></p></div><div id="https://www.notion.so/4a0281e341954319871cd64c16f75da5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">äºæ˜¯æˆ‘ä»¬ç«‹å³ç€æ‰‹ï¼Œç²¾ç®€äº†å‘ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">headers</code></span><span class="SemanticString"> ä¼ é€çš„æ•°æ®ï¼Œé‡æ–°å‘å¸ƒåï¼Œç»ˆäºä¸€åˆ‡å½’äºæ­£å¸¸ã€‚</span></span></p></div><h2 id="https://www.notion.so/7db6a99675b54eb9a1e521156d8a8efb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7db6a99675b54eb9a1e521156d8a8efb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">æ¢³ç†</span></span></h2><div id="https://www.notion.so/a98a987301c74bfe97b5c15f31ac5631" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è™½ç„¶é—®é¢˜å·²ç»å¾—åˆ°äº†è§£å†³ï¼Œä½†æ˜¯ä»æ—§éœ€è¦è¡¥é½ä¸€ä¸‹ç›¸å…³çŸ¥è¯†çš„çŸ­æ¿ã€‚</span></span></p></div><div id="https://www.notion.so/cfc4d165ce5843398fd8b2fc41006cde" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å†æ¥ç®€å•çœ‹çœ‹</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> AMQP </strong></span><span class="SemanticString"> </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.rabbitmq.com/resources/specs/amqp0-9-1.pdf">0.9.1 ç‰ˆæœ¬</a></span><span class="SemanticString"> </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åè®®æœ‰å…³è¿™éƒ¨åˆ†çš„å†…å®¹</strong></span><span class="SemanticString">ã€‚</span></span></p></div><h3 id="https://www.notion.so/86cc8022d8dd47a4b88d53d963f42d83" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/86cc8022d8dd47a4b88d53d963f42d83"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">AMQP åè®®</span></span></h3><div id="https://www.notion.so/a8d19ae7748e4dc1a5061749d4e2fcca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™æ˜¯åè®®ä¸­æ‰€æœ‰ TCP/IP å¸§ç»„æˆ</span></span></p></div><pre id="https://www.notion.so/ba3ca24110d24ba690a63f02a171a2fe" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>0      1         3         7                 </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>size</span></mark></span><span class="SemanticString"><span>+7 </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>size</span></mark></span><span class="SemanticString"><span>+8
+------+---------+---------+ +-------------+ +-----------+
| type | channel |   size  | |   payload   | | frame-end |
+------+---------+---------+ +-------------+ +-----------+
 octet    short      long      &#x27;</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>size</span></mark></span><span class="SemanticString"><span>&#x27; octets     octet</span></span></span></code></pre><div id="https://www.notion.so/676600f869f84f59b4e64084cec7f511" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å…¶ä¸­æœ‰è¿™ä¹ˆå‡ ä¸ªå…³é”®ä¿¡æ¯ï¼š</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/2f09203f74b748f3be10cabdb20c0db0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">0-7 bytes ç¡®å®šäº†å¸§çš„ç±»å‹å’Œå…·ä½“çš„ channelï¼Œç¡®å®šäº†ç±»å‹åå°†ä¼šå¤„ç† payload</span></span></li><li id="https://www.notion.so/d3a594aa61984fa99404f8cd8ca4a8e9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">payload çš„å¤§å°åœ¨åè®®ä¸­å¹¶æ²¡æœ‰è§„å®šï¼Œè€Œæ˜¯è¯´çš„æ˜¯å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„â€åå•†â€œç¡®å®š(page 22)</span></span></li><li id="https://www.notion.so/52493bc4e6f840a1b082ad59c0de9f38" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ä¸åŒç±»å‹å¸§æœ‰ç€ä¸åŒçš„ payload æ„æˆ</span></span></li></ul><div id="https://www.notion.so/b8f09d7fc80a418e93f8725e8a5646c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å½“å‰é—®é¢˜ä¸»è¦æ˜¯ä¼ é€’åº”ç”¨æ•°æ®çš„åœºæ™¯ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹å…·ä½“æ‰¿è½½çš„ Content å¸§</span></span></p></div><div id="https://www.notion.so/0a81baaf5dcc43b7993615955f6037e8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ç®€å•ç‚¹æ¥è¯´ï¼ŒContent å¸§å°±æ˜¯ä¸€ç³»åˆ—çš„ properties åŠ ä¸ŠäºŒè¿›åˆ¶çš„æ•°æ®éƒ¨åˆ†ã€‚è¿™äº› properties å°†ä¼šç»„æˆ &quot;content header frame&quot;ï¼Œå®ƒå¤§æ¦‚æ˜¯è¿™æ ·çš„ç»„æˆï¼š</span></span></p></div><pre id="https://www.notion.so/e83442dd55e84d0e9a4e35cb4059cc4e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>0          2        4           12               14
+----------+--------+-----------+----------------+------------- - -
| class-id | weight | body size | property flags | property list...
+----------+--------+-----------+----------------+------------- - -
    short    short    long long        short        remainder...</span></span></span></code></pre><div id="https://www.notion.so/595f1ce4948644bdbb91f4d1b72790c6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬çš„ celery ä»£ç ä¸­ï¼Œ </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">headers=(...)</code></span><span class="SemanticString"> ä¼ é€’çš„å†…å®¹å°†ä¼šè¢«å¡å…¥ property list ä¸­ï¼Œåœ¨åè®®ä¸­å¹¶æ²¡æœ‰æ˜ç¡®å…·ä½“çš„å¤§å°é™åˆ¶ï¼ŒåŒæ—¶æ²¡æœ‰è¡¨æ˜ä¼šåšçš„åˆ†å—(content body éƒ¨åˆ†æ˜¯ä¼šçš„)ï¼Œæ‰€ä»¥å½“å‰äº§ç”Ÿçš„é—®é¢˜é™åˆ¶ï¼Œä¸»è¦å—åˆ¶äº RabbitMQ çš„å…·ä½“å®ç°ã€‚</span></span></p></div><div id="https://www.notion.so/388e445a0fc04f07a54b5680417c3d5a" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F13faba46-c644-41e9-80b1-cdb3fb4659ad%2FUntitled.png?width=2372&amp;table=block&amp;id=388e445a-0fc0-4f07-a54b-5680417c3d5a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F13faba46-c644-41e9-80b1-cdb3fb4659ad%2FUntitled.png?width=2372&amp;table=block&amp;id=388e445a-0fc0-4f07-a54b-5680417c3d5a" style="width:100%"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.rabbitmq.com/posts/2012/11/breaking-things-with-rabbitmq-3-0/">https://blog.rabbitmq.com/posts/2012/11/breaking-things-with-rabbitmq-3-0/</a></span></span></figcaption></figure></div><h2 id="https://www.notion.so/93ac0ca987774403ac254778cdd65f93" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/93ac0ca987774403ac254778cdd65f93"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ä¸‰ç‚¹æ„Ÿæ‚Ÿ</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/420325f93e0e4c77a778ab83f866c9ab" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">é”™è¯¯ç›‘æµ‹éå¸¸é‡è¦</strong></span><span class="SemanticString">ã€‚å¦‚æœæ²¡æœ‰ Sentryï¼Œé—®é¢˜çš„å®šä½å¯èƒ½ä¼šæ›´åŠ å›°éš¾ï¼Œå¤šè€—å‡ å¤©ç²¾åŠ›ä¹Ÿæœªå¯çŸ¥ã€‚</span></span></li><li id="https://www.notion.so/f8a64554888c4561801cb475ed56888e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">è¦å–„äºåˆ©ç”¨ä¸åŒç»„ä»¶çš„ä¼˜åŠ¿</strong></span><span class="SemanticString">ã€‚ä¹‹æ‰€ä»¥ä¸€å¼€å§‹ä½¿ç”¨ Redis è€Œä¸æ˜¯ RabbitMQï¼Œæ›´å¤šæ˜¯ä»è¿è¥ç»´æŠ¤çš„è§’åº¦å‡ºå‘ï¼Œåœ¨å…¬å¸å†…éƒ¨ Redis æœ‰æ›´å®Œå–„çš„åŸºå»ºåŸºç¡€ï¼Œè€Œ RabbitMQ çš„è¿ç»´æ›´åŠ å¤æ‚ã€‚ä½†æ˜¯é‡åˆ°åƒè¿™æ ·å¹½çµèˆ¬çš„é—®é¢˜æ—¶ï¼ŒRabbitMQ åè€Œæ›´æœ‰ä¼˜åŠ¿ï¼Œå®Œå–„çš„æµç¨‹æ›´å®¹æ˜“æš´éœ²é—®é¢˜ã€‚</span></span></li><li id="https://www.notion.so/f0036dfe45914b8b92ec7b40c0fcfe5a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">è¦é€‚å½“åœ°äº†è§£é‡ç‚¹ä¾èµ–çš„æŠ€æœ¯ç»†èŠ‚</strong></span><span class="SemanticString">ã€‚å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œç®€å•åœ°ä½¿ç”¨åè®®å°±è¶³å¤Ÿäº†ï¼Œè€Œåœ¨ä¸€äº›è¾¹ç¼˜åœºæ™¯ä¸­ï¼Œåˆ™æ›´çœ‹é‡æŠ€æœ¯äººå‘˜å¯¹ç»†èŠ‚çš„æŠŠæ§ã€‚è¿™ç±»å±äºé‡è¦ä¸ç´§æ€¥çš„äº‹æƒ…ï¼Œåº”è¯¥å®šæ—¶æ‹¿å‡ºæ¥æœ‰æ„è¯†å»åšï¼Œè™½æ— è¿‘ç”¨ï¼Œå´æœ‰è¿œç›Šã€‚</span></span></li></ul><div id="https://www.notion.so/052ca29f83ba4a5987af85f7e1dfe9fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fac815e796804a29abeadedbee1bbb2e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å‚è€ƒï¼š</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/936cf8c56f2243d794d9cac0e09a843d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.rabbitmq.com/resources/specs/amqp0-9-1.pdf">https://www.rabbitmq.com/resources/specs/amqp0-9-1.pdf</a></span></span></li><li id="https://www.notion.so/6abf66b219ed4e0fa7c31293b377d5e9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://john.eckersberg.com/debugging-rabbitmq-frame_too_large-error.html">https://john.eckersberg.com/debugging-rabbitmq-frame_too_large-error.html</a></span></span></li><li id="https://www.notion.so/85809243e019434b995acd58e4c83dc7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://stackoverflow.com/questions/30716002/is-there-a-size-limit-on-a-rabbitmq-message-header">https://stackoverflow.com/questions/30716002/is-there-a-size-limit-on-a-rabbitmq-message-header</a></span></span></li><li id="https://www.notion.so/d33435f0e11f432daa63676c3d94db4c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.rabbitmq.com/amqp-0-9-1-errata.html#section_11">https://www.rabbitmq.com/amqp-0-9-1-errata.html#section_11</a></span></span></li></ul><div id="https://www.notion.so/9470c222e7464529b4fdd20a8691ddfe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>

  <!-- utterances - Github issue comment -->
  <div>
    <script src="https://utteranc.es/client.js"
      repo="IMBlues/IMBlues.github.io"
      issue-term="pathname"
      label="blog-comment"
      theme="github-light"
      crossorigin="anonymous"
      async>
    </script>
  </div>
  <!-- utterances - Github issue comment -->

  <footer class="Footer">
  <div>&copy; å¸ƒé²æ–¯é±¼çš„å¥‡æ€ä¹±æƒ³ ğŸ’­ 2019-2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>
